# 统计主要转录组和非转录组的碱基数
1.  **提取**：从 GTF 取出感兴趣的转录本坐标
2.  **转格式**：变成 BED
3.  **去重合并**：避免重复计算   
4.  **统计** transcript 碱基数
5.  **生成基因组区间**    
6.  **相减** 得到非 transcript 区域  
7.  **统计**非 transcript 碱基数
8.  **统计**5'UTR 长度
9. **统计**CDS 长度
10.   **统计** 3'UTR 长度

这样 transcript + non-transcript = 基因组总长度（只要 BED 区间完全覆盖全基因组且不重叠）。
```
#!/bin/bash

GTF="protein_coding_mane_transcript.gtf"
FASTA="Homo_sapiens.GRCh38.dna.primary_assembly.fa"

cut -f1,4,5 $GTF | awk 'BEGIN{OFS="\t"} {print $1, $2-1, $3}' > mane_pc_transcript.bed

bedtools sort -i mane_pc_transcript.bed | bedtools merge -i - > mane_pc_transcript_merged.bed

awk '{sum += $3 - $2} END {print "Transcript region length:", sum}' mane_pc_transcript_merged.bed

samtools faidx $FASTA
cut -f1,2 ${FASTA}.fai | awk 'BEGIN{OFS="\t"} {print $1, 0, $2}' > genome.bed

bedtools subtract -a genome.bed -b mane_pc_transcript_merged.bed > non_transcript.bed
awk '{sum += $3 - $2} END {print "Non-transcript region length:", sum}' non_transcript.bed

grep -w "five_prime_utr" $GTF | cut -f1,4,5 | awk 'BEGIN{OFS="\t"} {print $1, $2-1, $3}' | bedtools sort -i - | bedtools merge -i - | awk '{sum += $3 - $2} END {print \"5'UTR length:\", sum}'

grep -w "CDS" $GTF | cut -f1,4,5 | awk 'BEGIN{OFS="\t"} {print $1, $2-1, $3}' | bedtools sort -i - | bedtools merge -i - | awk '{sum += $3 - $2} END {print "CDS length:", sum}'

grep -w "three_prime_utr" $GTF | cut -f1,4,5 | awk 'BEGIN{OFS="\t"} {print $1, $2-1, $3}' | bedtools sort -i - | bedtools merge -i - | awk '{sum += $3 - $2} END {print \"3'UTR length:\", sum}'
```
<!--stackedit_data:
eyJoaXN0b3J5IjpbMTg5OTkxNzU0MywxNTQ3MjA4Mjk1LDEzOD
U4NjMxNTUsMTgxMzg5ODc4NV19
-->