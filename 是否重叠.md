---


---

<pre><code>from collections import defaultdict

motif_to_regions = defaultdict(set)

def parse_merge_file(filename, region_label):
    with open(filename) as f:
        for line in f:
            fields = line.strip().split()
            if len(fields) &lt; 11:
                continue

            chrom = fields[0]
            motif_start = fields[7]
            motif_end = fields[8]
            motif_seq = fields[9]
            strand = fields[10]

            motif_key = (chrom, motif_start, motif_end, motif_seq, strand)
            motif_to_regions[motif_key].add(region_label)

parse_merge_file("cds_merge.txt", "CDS")
parse_merge_file("3utr_merge.txt", "3UTR")
parse_merge_file("5utr_merge.txt", "5UTR")
parse_merge_file("intron_merge.txt", "Intron")

with open("motif_multi_region_hits.txt", "w") as out:
    out.write("Chr\tStart\tEnd\tMotif\tStrand\tRegions\n")
    for motif_key, regions in motif_to_regions.items():
        if len(regions) &gt; 1:
            out.write("\t".join(motif_key) + "\t" + ",".join(sorted(regions)) + "\n")

print("over!")
</code></pre>

